<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Meme Habel">
<meta name="dcterms.date" content="2024-04-19">

<title>Code File – Meme Habel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Meme Habel</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tableau" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tableau</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tableau">    
        <li class="dropdown-header">Makeover Monday: AirHelp Scores</li>
        <li>
    <a class="dropdown-item" href="./AirHelp_Scores.html">
 <span class="dropdown-text">Dashboard</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">R</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r">    
        <li class="dropdown-header">Global Nutrition and Health</li>
        <li>
    <a class="dropdown-item" href="./Capstone_Abstract.html">
 <span class="dropdown-text">Abstract</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Capstone_Code.html">
 <span class="dropdown-text">Code File</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Boston Housing Analysis</li>
        <li>
    <a class="dropdown-item" href="./BostonHousing_Abstract.html">
 <span class="dropdown-text">Abstract</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./BostonHousing_Code.html">
 <span class="dropdown-text">Code File</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./BostonHousing_Presentation.html">
 <span class="dropdown-text">Presentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./BostonHousing_Abstract.html">Boston Housing Analysis</a></li><li class="breadcrumb-item"><a href="./BostonHousing_Code.html">Code File</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Global Nutrition and Health</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Capstone_Abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Capstone_Code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code File</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Boston Housing Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BostonHousing_Abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BostonHousing_Code.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Code File</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BostonHousing_Presentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#individual-boston-housing-case-study" id="toc-individual-boston-housing-case-study" class="nav-link active" data-scroll-target="#individual-boston-housing-case-study">Individual Boston Housing Case Study</a>
  <ul class="collapse">
  <li><a href="#load-packages-and-data" id="toc-load-packages-and-data" class="nav-link" data-scroll-target="#load-packages-and-data">Load Packages and Data</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load Packages</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load Data</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#data-definitions" id="toc-data-definitions" class="nav-link" data-scroll-target="#data-definitions">Data Definitions</a></li>
  <li><a href="#data-preview" id="toc-data-preview" class="nav-link" data-scroll-target="#data-preview">Data Preview</a></li>
  <li><a href="#dimensionality" id="toc-dimensionality" class="nav-link" data-scroll-target="#dimensionality">Dimensionality</a></li>
  <li><a href="#data-structure" id="toc-data-structure" class="nav-link" data-scroll-target="#data-structure">Data Structure</a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics">Summary Statistics</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing Values</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  <li><a href="#distribution-of-data-medv" id="toc-distribution-of-data-medv" class="nav-link" data-scroll-target="#distribution-of-data-medv">Distribution of Data (‘medv’)</a></li>
  <li><a href="#boxplots-of-medv-vs.-categorical-variables" id="toc-boxplots-of-medv-vs.-categorical-variables" class="nav-link" data-scroll-target="#boxplots-of-medv-vs.-categorical-variables">Boxplots of ‘medv’ vs.&nbsp;Categorical Variables</a></li>
  <li><a href="#scatterplots-of-medv-vs.-continuous-variables" id="toc-scatterplots-of-medv-vs.-continuous-variables" class="nav-link" data-scroll-target="#scatterplots-of-medv-vs.-continuous-variables">Scatterplots of ‘medv’ vs.&nbsp;Continuous Variables</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#training-and-testing-data-split" id="toc-training-and-testing-data-split" class="nav-link" data-scroll-target="#training-and-testing-data-split">Training and Testing Data Split</a></li>
  </ul></li>
  <li><a href="#model-creation-and-evaluation" id="toc-model-creation-and-evaluation" class="nav-link" data-scroll-target="#model-creation-and-evaluation">Model Creation and Evaluation</a>
  <ul class="collapse">
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model">1. Linear Model</a></li>
  <li><a href="#regression-tree" id="toc-regression-tree" class="nav-link" data-scroll-target="#regression-tree">2. Regression Tree</a></li>
  <li><a href="#k-nn-with-optimal-k" id="toc-k-nn-with-optimal-k" class="nav-link" data-scroll-target="#k-nn-with-optimal-k">3. k-NN with optimal k</a></li>
  <li><a href="#random-forests" id="toc-random-forests" class="nav-link" data-scroll-target="#random-forests">4. Random Forests</a></li>
  <li><a href="#boosting" id="toc-boosting" class="nav-link" data-scroll-target="#boosting">5. Boosting</a></li>
  <li><a href="#gam" id="toc-gam" class="nav-link" data-scroll-target="#gam">6. GAM</a></li>
  <li><a href="#neural-networks" id="toc-neural-networks" class="nav-link" data-scroll-target="#neural-networks">7. Neural Networks</a></li>
  </ul></li>
  <li><a href="#summary-of-model-results" id="toc-summary-of-model-results" class="nav-link" data-scroll-target="#summary-of-model-results">Summary of Model Results</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./BostonHousing_Abstract.html">Boston Housing Analysis</a></li><li class="breadcrumb-item"><a href="./BostonHousing_Code.html">Code File</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Code File</h1>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Meme Habel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="individual-boston-housing-case-study" class="level1 tabset">
<h1 class="tabset">Individual Boston Housing Case Study</h1>
<section id="load-packages-and-data" class="level2">
<h2 class="anchored" data-anchor-id="load-packages-and-data">Load Packages and Data</h2>
<section id="load-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-packages">Load Packages</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotmo)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FNN)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neuralnet)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load Data</h3>
<p>For this case study, I will be using the Boston Housing Data found in the MASS package. The target variable is median value of owner-occupied homes in $1,000 (‘medv’), which is continuous. This is the same data we have been using for the entirety of the Data Mining I and II courses this semester.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Boston); <span class="co">#this data is in MASS package</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<section id="data-definitions" class="level3">
<h3 class="anchored" data-anchor-id="data-definitions">Data Definitions</h3>
<ul>
<li>crim: per capita crime rate by town</li>
<li>zn: proportion of residential land zoned for lots over 25,000 sq.ft.</li>
<li>Indus: proportion of non-retail business acres per town</li>
<li>chas: Charles River dummy variable
<ul>
<li>1 if tract bounds river</li>
<li>0 otherwise</li>
</ul></li>
<li>nox: nitrogen oxides concentration (parts per 10 million)</li>
<li>rm: average number of rooms per dwelling</li>
<li>age: proportion of owner-occupied units built prior to 1940</li>
<li>dis: weighted mean of distances to five Boston employment centres</li>
<li>rad: index of accessibility to radial highways</li>
<li>tax: full-value property-tax rate per $10,000</li>
<li>ptratio: pupil-teacher ratio by town</li>
<li>black : 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town</li>
<li>lstat : lower status of the population (percent)</li>
<li>medv(Y): median value of owner-occupied homes in $1,000</li>
</ul>
</section>
<section id="data-preview" class="level3">
<h3 class="anchored" data-anchor-id="data-preview">Data Preview</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     crim zn indus chas   nox    rm  age    dis rad tax ptratio  black lstat
1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90  4.98
2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90  9.14
3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83  4.03
4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63  2.94
5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90  5.33
6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12  5.21
  medv
1 24.0
2 21.6
3 34.7
4 33.4
5 36.2
6 28.7</code></pre>
</div>
</div>
</section>
<section id="dimensionality" class="level3">
<h3 class="anchored" data-anchor-id="dimensionality">Dimensionality</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 506  14</code></pre>
</div>
</div>
<p>There are 506 rows of data and 14 columns, with each column representing a different variable.</p>
</section>
<section id="data-structure" class="level3">
<h3 class="anchored" data-anchor-id="data-structure">Data Structure</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   506 obs. of  14 variables:
 $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
 $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
 $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
 $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
 $ rm     : num  6.58 6.42 7.18 7 7.15 ...
 $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
 $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
 $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
 $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
 $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
 $ black  : num  397 397 393 395 397 ...
 $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
 $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...</code></pre>
</div>
</div>
</section>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      crim                zn             indus            chas        
 Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000  
 1st Qu.: 0.08205   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000  
 Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000  
 Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917  
 3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000  
 Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000  
      nox               rm             age              dis        
 Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130  
 1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100  
 Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207  
 Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795  
 3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188  
 Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127  
      rad              tax           ptratio          black       
 Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32  
 1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38  
 Median : 5.000   Median :330.0   Median :19.05   Median :391.44  
 Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67  
 3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23  
 Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90  
     lstat            medv      
 Min.   : 1.73   Min.   : 5.00  
 1st Qu.: 6.95   1st Qu.:17.02  
 Median :11.36   Median :21.20  
 Mean   :12.65   Mean   :22.53  
 3rd Qu.:16.95   3rd Qu.:25.00  
 Max.   :37.97   Max.   :50.00  </code></pre>
</div>
</div>
<p>After looking at the data structure and summary statistics, I conclude that all feature variables are continuous with the exceptions of ‘chas’ and ‘rad’. The ‘chas’ variable is a binary categorical variable and ‘rad’ is a multi-level categorical variable. However, dummy encoding is not required as the data for these variables are in integer form.</p>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing Values</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(Boston))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>There are no missing values for this data set.</p>
</section>
<section id="correlation" class="level3">
<h3 class="anchored" data-anchor-id="correlation">Correlation</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(Boston)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">abs</span>(cor_matrix[,<span class="st">"medv"</span>]), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     medv     lstat        rm   ptratio     indus       tax       nox      crim 
1.0000000 0.7376627 0.6953599 0.5077867 0.4837252 0.4685359 0.4273208 0.3883046 
      rad       age        zn     black       dis      chas 
0.3816262 0.3769546 0.3604453 0.3334608 0.2499287 0.1752602 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cor_plot <span class="ot">&lt;-</span> <span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-data-medv" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-data-medv">Distribution of Data (‘medv’)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Boston<span class="sc">$</span>medv, <span class="at">main =</span> <span class="st">"Distribution of Median Home Values (medv)"</span>, <span class="at">xlab =</span> <span class="st">"medv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histogram above, we can see the data roughly follows a normal distribution, with a positive skew. The most common ‘bin’ of median home value is $200,000 to $250,000.</p>
</section>
<section id="boxplots-of-medv-vs.-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="boxplots-of-medv-vs.-categorical-variables">Boxplots of ‘medv’ vs.&nbsp;Categorical Variables</h3>
<section id="chas" class="level4">
<h4 class="anchored" data-anchor-id="chas">‘chas’</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot of 'medv' vs. 'chas'</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(medv <span class="sc">~</span> chas, <span class="at">data =</span> Boston, <span class="at">main =</span> <span class="st">"medv vs. chas"</span>, <span class="at">xlab =</span> <span class="st">"chas (z = tract bounds river, 0 = otherwise)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rad" class="level4">
<h4 class="anchored" data-anchor-id="rad">‘rad’</h4>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot of 'medv' vs. 'chas'</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(medv <span class="sc">~</span> <span class="fu">as.factor</span>(rad), <span class="at">data =</span> Boston, <span class="at">main =</span> <span class="st">"medv vs. rad"</span>, <span class="at">xlab =</span> <span class="st">"rad (index of accessibility to radial highways)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="scatterplots-of-medv-vs.-continuous-variables" class="level3">
<h3 class="anchored" data-anchor-id="scatterplots-of-medv-vs.-continuous-variables">Scatterplots of ‘medv’ vs.&nbsp;Continuous Variables</h3>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify continuous variables</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"crim"</span>, <span class="st">"zn"</span>, <span class="st">"indus"</span>, <span class="st">"nox"</span>, <span class="st">"rm"</span>, <span class="st">"age"</span>, <span class="st">"dis"</span>, <span class="st">"tax"</span>, <span class="st">"ptratio"</span>, <span class="st">"black"</span>, <span class="st">"lstat"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplots for continuous variables</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> continuous_vars) {</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Boston[[var]], Boston<span class="sc">$</span>medv, <span class="at">xlab =</span> var, <span class="at">ylab =</span> <span class="st">"medv"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"medv vs."</span>, var))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p>Above, there are some relationships that appear strong. Particularly, the ‘rm’ and ‘lstat’ variables seem to have somewhat linear relationships with the ‘medv’ variable. Here, ‘rm’ has a positive relationship and ‘lstat’ has a negative relationship with the target variable.</p>
</section>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<section id="training-and-testing-data-split" class="level3">
<h3 class="anchored" data-anchor-id="training-and-testing-data-split">Training and Testing Data Split</h3>
<p>Below I will perform a 80%/20% training and testing data split using my UC M# (12470675) as the seed for reproducibility.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12470675</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sample_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(Boston),<span class="fu">nrow</span>(Boston)<span class="sc">*</span><span class="fl">0.80</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Boston_train <span class="ot">&lt;-</span> Boston[sample_index,]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>Boston_test <span class="ot">&lt;-</span> Boston[<span class="sc">-</span>sample_index,]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Boston_train)[<span class="dv">1</span>] <span class="co"># sample size</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">dim</span>(Boston)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span> <span class="co"># number of predictors excluding column of ones</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="model-creation-and-evaluation" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="model-creation-and-evaluation">Model Creation and Evaluation</h2>
<section id="linear-model" class="level3">
<h3 class="anchored" data-anchor-id="linear-model">1. Linear Model</h3>
<section id="full-linear-model" class="level4">
<h4 class="anchored" data-anchor-id="full-linear-model">Full Linear Model</h4>
<section id="model-creation" class="level5">
<h5 class="anchored" data-anchor-id="model-creation">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full Model</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Boston.full.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston_train)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston.full.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ ., data = Boston_train)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.9396  -2.6215  -0.5663   1.6203  24.5936 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.181823   5.643028   6.589 1.44e-10 ***
crim         -0.082154   0.047949  -1.713 0.087439 .  
zn            0.046544   0.015206   3.061 0.002360 ** 
indus         0.055608   0.072621   0.766 0.444301    
chas          3.270900   0.941602   3.474 0.000571 ***
nox         -18.833509   4.385189  -4.295 2.21e-05 ***
rm            3.465980   0.457537   7.575 2.63e-13 ***
age           0.015072   0.015452   0.975 0.329946    
dis          -1.397762   0.228223  -6.125 2.22e-09 ***
rad           0.341886   0.077889   4.389 1.47e-05 ***
tax          -0.015169   0.004393  -3.453 0.000616 ***
ptratio      -0.842302   0.146235  -5.760 1.71e-08 ***
black         0.009523   0.003116   3.056 0.002394 ** 
lstat        -0.622804   0.058112 -10.717  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.764 on 390 degrees of freedom
Multiple R-squared:  0.7439,    Adjusted R-squared:  0.7354 
F-statistic: 87.15 on 13 and 390 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="model-evaluation" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample fit (prediction), full data available #</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ASE_full_linear <span class="ot">&lt;-</span> <span class="fu">mean</span>(Boston.full.lm<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample fit (prediction) MSPE for full LM model #</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>pred_full_linear_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston.full.lm, Boston_test)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>MSPE_full_linear <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_test<span class="sc">$</span>medv <span class="sc">-</span> pred_full_linear_test)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Full Linear Model Results:</strong></p>
<ul>
<li>ASE: 21.9136453</li>
<li>MSPE: 23.4721289</li>
</ul>
</section>
</section>
<section id="stepwise-variable-selection-with-aic" class="level4">
<h4 class="anchored" data-anchor-id="stepwise-variable-selection-with-aic">Stepwise Variable Selection with AIC</h4>
<section id="model-creation-1" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-1">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lm_model_null <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston_train)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_step_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>   lm_model_null,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> lm_model_null, <span class="at">upper =</span> Boston.full.lm),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1799.56
medv ~ 1

          Df Sum of Sq   RSS    AIC
+ lstat    1   19532.0 15041 1465.3
+ rm       1   15883.2 18690 1553.1
+ ptratio  1    8068.4 26504 1694.2
+ indus    1    7393.3 27180 1704.4
+ tax      1    7186.5 27386 1707.4
+ nox      1    5992.6 28580 1724.7
+ crim     1    5582.1 28991 1730.4
+ age      1    4484.3 30089 1745.4
+ rad      1    4419.3 30153 1746.3
+ black    1    4185.4 30387 1749.4
+ zn       1    4115.4 30457 1750.4
+ dis      1    1643.2 32930 1781.9
+ chas     1    1321.8 33251 1785.8
&lt;none&gt;                 34573 1799.6

Step:  AIC=1465.31
medv ~ lstat

          Df Sum of Sq   RSS    AIC
+ rm       1    2922.7 12118 1380.0
+ ptratio  1    1525.2 13516 1424.1
+ chas     1     856.3 14185 1443.6
+ dis      1     673.4 14367 1448.8
+ age      1     485.0 14556 1454.1
+ tax      1     147.2 14894 1463.3
+ black    1     123.1 14918 1464.0
+ zn       1      79.1 14962 1465.2
&lt;none&gt;                 15041 1465.3
+ indus    1      34.0 15007 1466.4
+ crim     1      30.5 15010 1466.5
+ nox      1       6.4 15034 1467.1
+ rad      1       1.6 15039 1467.3
- lstat    1   19532.0 34573 1799.6

Step:  AIC=1380.02
medv ~ lstat + rm

          Df Sum of Sq   RSS    AIC
+ ptratio  1     998.9 11119 1347.3
+ chas     1     590.1 11528 1361.9
+ dis      1     366.7 11752 1369.6
+ black    1     320.7 11797 1371.2
+ tax      1     224.4 11894 1374.5
+ age      1     142.9 11975 1377.2
+ rad      1      62.4 12056 1379.9
&lt;none&gt;                 12118 1380.0
+ crim     1      55.4 12063 1380.2
+ zn       1      25.2 12093 1381.2
+ indus    1      19.4 12099 1381.4
+ nox      1       2.4 12116 1381.9
- rm       1    2922.7 15041 1465.3
- lstat    1    6571.4 18690 1553.1

Step:  AIC=1347.27
medv ~ lstat + rm + ptratio

          Df Sum of Sq   RSS    AIC
+ dis      1     499.5 10620 1330.7
+ chas     1     470.7 10649 1331.8
+ black    1     277.8 10842 1339.0
+ age      1     206.9 10912 1341.7
&lt;none&gt;                 11119 1347.3
+ rad      1      22.1 11097 1348.5
+ tax      1      18.4 11101 1348.6
+ zn       1      18.2 11101 1348.6
+ indus    1       8.9 11110 1349.0
+ crim     1       4.9 11114 1349.1
+ nox      1       0.9 11118 1349.2
- ptratio  1     998.9 12118 1380.0
- rm       1    2396.4 13516 1424.1
- lstat    1    5006.2 16125 1495.4

Step:  AIC=1330.7
medv ~ lstat + rm + ptratio + dis

          Df Sum of Sq   RSS    AIC
+ nox      1     532.7 10087 1311.9
+ black    1     390.9 10229 1317.5
+ chas     1     339.8 10280 1319.6
+ tax      1     199.2 10420 1325.0
+ indus    1     185.3 10434 1325.6
+ zn       1     119.5 10500 1328.1
+ crim     1      57.6 10562 1330.5
&lt;none&gt;                 10620 1330.7
+ rad      1      10.6 10609 1332.3
+ age      1       0.5 10619 1332.7
- dis      1     499.5 11119 1347.3
- ptratio  1    1131.7 11752 1369.6
- rm       1    2051.1 12671 1400.0
- lstat    1    5424.4 16044 1495.4

Step:  AIC=1311.91
medv ~ lstat + rm + ptratio + dis + nox

          Df Sum of Sq     RSS    AIC
+ chas     1     408.8  9678.3 1297.2
+ black    1     248.5  9838.5 1303.8
+ zn       1     122.2  9964.9 1309.0
+ rad      1      58.0 10029.1 1311.6
&lt;none&gt;                 10087.1 1311.9
+ age      1      23.9 10063.2 1313.0
+ crim     1      20.7 10066.3 1313.1
+ tax      1      12.9 10074.2 1313.4
+ indus    1      12.4 10074.7 1313.4
- nox      1     532.7 10619.7 1330.7
- dis      1    1031.3 11118.4 1349.2
- ptratio  1    1236.2 11323.2 1356.6
- rm       1    1984.4 12071.4 1382.5
- lstat    1    3909.0 13996.1 1442.2

Step:  AIC=1297.2
medv ~ lstat + rm + ptratio + dis + nox + chas

          Df Sum of Sq     RSS    AIC
+ black    1     202.0  9476.3 1290.7
+ zn       1     132.2  9546.1 1293.6
+ rad      1      64.0  9614.4 1296.5
&lt;none&gt;                  9678.3 1297.2
+ indus    1      22.2  9656.1 1298.3
+ age      1      12.5  9665.8 1298.7
+ crim     1      10.4  9667.9 1298.8
+ tax      1       5.4  9672.9 1299.0
- chas     1     408.8 10087.1 1311.9
- nox      1     601.7 10280.0 1319.6
- dis      1     949.8 10628.1 1333.0
- ptratio  1    1093.6 10771.9 1338.5
- rm       1    1867.6 11545.9 1366.5
- lstat    1    3757.6 13435.9 1427.7

Step:  AIC=1290.67
medv ~ lstat + rm + ptratio + dis + nox + chas + black

          Df Sum of Sq     RSS    AIC
+ zn       1     156.8  9319.5 1285.9
+ rad      1     140.7  9335.6 1286.6
&lt;none&gt;                  9476.3 1290.7
+ indus    1      12.8  9463.5 1292.1
+ age      1       2.8  9473.6 1292.6
+ tax      1       0.7  9475.6 1292.7
+ crim     1       0.1  9476.2 1292.7
- black    1     202.0  9678.3 1297.2
- chas     1     362.2  9838.5 1303.8
- nox      1     456.3  9932.6 1307.7
- dis      1     922.6 10398.9 1326.2
- ptratio  1    1061.9 10538.2 1331.6
- rm       1    1991.5 11467.8 1365.7
- lstat    1    3188.0 12664.3 1405.8

Step:  AIC=1285.93
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn

          Df Sum of Sq     RSS    AIC
+ rad      1      92.8  9226.7 1283.9
&lt;none&gt;                  9319.5 1285.9
+ indus    1      13.5  9306.0 1287.3
+ age      1      11.6  9307.9 1287.4
+ tax      1       5.6  9313.9 1287.7
+ crim     1       4.2  9315.4 1287.8
- zn       1     156.8  9476.3 1290.7
- black    1     226.5  9546.1 1293.6
- chas     1     370.0  9689.5 1299.7
- nox      1     452.8  9772.3 1303.1
- ptratio  1     760.8 10080.3 1315.6
- dis      1    1071.0 10390.5 1327.9
- rm       1    1813.5 11133.0 1355.8
- lstat    1    3200.1 12519.7 1403.2

Step:  AIC=1283.89
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    rad

          Df Sum of Sq     RSS    AIC
+ tax      1     266.9  8959.8 1274.0
+ crim     1      58.0  9168.7 1283.3
&lt;none&gt;                  9226.7 1283.9
+ indus    1      22.4  9204.3 1284.9
+ age      1      18.1  9208.5 1285.1
- rad      1      92.8  9319.5 1285.9
- zn       1     108.9  9335.6 1286.6
- black    1     286.0  9512.6 1294.2
- chas     1     368.5  9595.2 1297.7
- nox      1     545.6  9772.3 1305.1
- ptratio  1     833.2 10059.9 1316.8
- dis      1    1032.0 10258.7 1324.7
- rm       1    1677.1 10903.8 1349.4
- lstat    1    3253.8 12480.5 1403.9

Step:  AIC=1274.03
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    rad + tax

          Df Sum of Sq     RSS    AIC
+ crim     1     71.34  8888.4 1272.8
&lt;none&gt;                  8959.8 1274.0
+ age      1     24.09  8935.7 1274.9
+ indus    1     16.48  8943.3 1275.3
- zn       1    167.37  9127.2 1279.5
- tax      1    266.88  9226.7 1283.9
- black    1    267.36  9227.1 1283.9
- chas     1    320.42  9280.2 1286.2
- rad      1    354.14  9313.9 1287.7
- nox      1    355.95  9315.7 1287.8
- ptratio  1    711.09  9670.9 1302.9
- dis      1   1117.44 10077.2 1319.5
- rm       1   1487.26 10447.0 1334.1
- lstat    1   3136.23 12096.0 1393.3

Step:  AIC=1272.8
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    rad + tax + crim

          Df Sum of Sq     RSS    AIC
&lt;none&gt;                  8888.4 1272.8
+ age      1     22.03  8866.4 1273.8
- crim     1     71.34  8959.8 1274.0
+ indus    1     13.74  8874.7 1274.2
- zn       1    191.16  9079.6 1279.4
- black    1    222.98  9111.4 1280.8
- tax      1    280.21  9168.7 1283.3
- chas     1    302.20  9190.7 1284.3
- nox      1    388.03  9276.5 1288.1
- rad      1    423.82  9312.3 1289.6
- ptratio  1    731.94  9620.4 1302.8
- dis      1   1181.25 10069.7 1321.2
- rm       1   1408.23 10296.7 1330.2
- lstat    1   2850.26 11738.7 1383.2</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_step_aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat + rm + ptratio + dis + nox + chas + 
    black + zn + rad + tax + crim, data = Boston_train)

Coefficients:
(Intercept)        lstat           rm      ptratio          dis          nox  
  36.536739    -0.597600     3.526654    -0.820468    -1.510276   -16.876452  
       chas        black           zn          rad          tax         crim  
   3.406978     0.009707     0.043587     0.317333    -0.013337    -0.084897  </code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_step_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat + rm + ptratio + dis + nox + chas + 
    black + zn + rad + tax + crim, data = Boston_train)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1595  -2.6561  -0.7108   1.7077  25.1558 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  36.536739   5.609373   6.514 2.25e-10 ***
lstat        -0.597600   0.053301 -11.212  &lt; 2e-16 ***
rm            3.526654   0.447502   7.881 3.25e-14 ***
ptratio      -0.820468   0.144409  -5.682 2.61e-08 ***
dis          -1.510276   0.209245  -7.218 2.76e-12 ***
nox         -16.876452   4.079595  -4.137 4.31e-05 ***
chas          3.406978   0.933234   3.651 0.000297 ***
black         0.009707   0.003096   3.136 0.001842 ** 
zn            0.043587   0.015012   2.904 0.003898 ** 
rad           0.317333   0.073400   4.323 1.95e-05 ***
tax          -0.013337   0.003794  -3.515 0.000491 ***
crim         -0.084897   0.047864  -1.774 0.076886 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.762 on 392 degrees of freedom
Multiple R-squared:  0.7429,    Adjusted R-squared:  0.7357 
F-statistic:   103 on 11 and 392 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="model-evaluation-1" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-1">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample fit (prediction)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ASE_step_AIC <span class="ot">&lt;-</span> <span class="fu">mean</span>(model_step_aic<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample fit (prediction) MSPE for full LM model #</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>pred_step_AIC <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_step_aic, Boston_test)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>MSPE_step_AIC <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_test<span class="sc">$</span>medv <span class="sc">-</span> pred_step_AIC)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Stepwise Variable Selection with AIC Model Results:</strong></p>
<ul>
<li>ASE: 22.0011133</li>
<li>MSPE: 22.7308494</li>
</ul>
</section>
</section>
</section>
<section id="regression-tree" class="level3">
<h3 class="anchored" data-anchor-id="regression-tree">2. Regression Tree</h3>
<section id="original-regression-tree" class="level4">
<h4 class="anchored" data-anchor-id="original-regression-tree">Original Regression Tree</h4>
<section id="model-creation-2" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-2">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>boston_rpart <span class="ot">&lt;-</span> <span class="fu">rpart</span>(<span class="at">formula =</span> medv <span class="sc">~</span> ., <span class="at">data =</span> Boston_train)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>boston_rpart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>n= 404 

node), split, n, deviance, yval
      * denotes terminal node

 1) root 404 34572.7900 22.69332  
   2) rm&lt; 6.8375 335 13509.0200 19.81224  
     4) lstat&gt;=14.4 133  2178.6410 14.69173  
       8) dis&lt; 1.92035 52   555.7452 11.64038 *
       9) dis&gt;=1.92035 81   827.9225 16.65062 *
     5) lstat&lt; 14.4 202  5547.1360 23.18366  
      10) dis&gt;=1.6009 195  2544.1640 22.69436  
        20) rm&lt; 6.543 160  1306.4570 21.71437 *
        21) rm&gt;=6.543 35   381.6069 27.17429 *
      11) dis&lt; 1.6009 7  1655.7290 36.81429 *
   3) rm&gt;=6.8375 69  4782.5460 36.68116  
     6) rm&lt; 7.437 44  1448.6250 32.28182  
      12) lstat&gt;=5.515 24   676.1250 29.57500 *
      13) lstat&lt; 5.515 20   385.6420 35.53000 *
     7) rm&gt;=7.437 25   983.5456 44.42400 *</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">prp</span>(boston_rpart,<span class="at">digits =</span> <span class="dv">4</span>, <span class="at">extra =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-evaluation-2" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-2">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#in-sample prediction</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>boston_train_pred_tree <span class="ot">=</span> <span class="fu">predict</span>(boston_rpart, Boston_train)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the squared residuals</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sq_residuals_tree <span class="ot">&lt;-</span> (Boston_train<span class="sc">$</span>medv <span class="sc">-</span> boston_train_pred_tree)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate ASE</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>ASE_regression_tree <span class="ot">&lt;-</span> <span class="fu">mean</span>(sq_residuals_tree)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#out-of-sample prediction </span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>boston_test_pred_tree <span class="ot">=</span> <span class="fu">predict</span>(boston_rpart,Boston_test)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>MSPE_regression_tree <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_test<span class="sc">$</span>medv <span class="sc">-</span> boston_test_pred_tree)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Original Regression Tree Results:</strong></p>
<ul>
<li>ASE: 16.7642887</li>
<li>MSPE: 21.8385347</li>
</ul>
</section>
</section>
<section id="pruned-regression-tree" class="level4">
<h4 class="anchored" data-anchor-id="pruned-regression-tree">Pruned Regression Tree</h4>
<section id="model-creation-3" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-3">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>boston_largetree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(<span class="at">formula =</span> medv <span class="sc">~</span> ., <span class="at">data =</span> Boston_train, <span class="at">cp =</span> <span class="fl">0.001</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(boston_largetree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(boston_largetree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression tree:
rpart(formula = medv ~ ., data = Boston_train, cp = 0.001)

Variables actually used in tree construction:
 [1] age     black   crim    dis     lstat   nox     ptratio rad     rm     
[10] tax     zn     

Root node error: 34573/404 = 85.576

n= 404 

          CP nsplit rel error  xerror     xstd
1  0.4709260      0   1.00000 1.00474 0.091200
2  0.1672773      1   0.52907 0.60310 0.060112
3  0.0679834      2   0.36180 0.42510 0.051640
4  0.0389683      3   0.29381 0.32170 0.047843
5  0.0247622      4   0.25485 0.33591 0.049337
6  0.0229942      5   0.23008 0.32342 0.046948
7  0.0111897      6   0.20709 0.29690 0.046640
8  0.0096089      7   0.19590 0.28637 0.041385
9  0.0086255      8   0.18629 0.28702 0.041487
10 0.0080935      9   0.17766 0.28047 0.042316
11 0.0065956     10   0.16957 0.27192 0.042385
12 0.0047170     11   0.16298 0.25626 0.040147
13 0.0034662     12   0.15826 0.25132 0.039965
14 0.0033310     13   0.15479 0.25904 0.042161
15 0.0024317     14   0.15146 0.25779 0.042147
16 0.0022426     15   0.14903 0.25368 0.042043
17 0.0019186     16   0.14679 0.24882 0.041281
18 0.0016136     17   0.14487 0.24916 0.041261
19 0.0015932     18   0.14325 0.25073 0.041301
20 0.0014894     19   0.14166 0.25196 0.041289
21 0.0013622     20   0.14017 0.25017 0.041143
22 0.0011861     21   0.13881 0.25000 0.041147
23 0.0010000     22   0.13762 0.25088 0.041161</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>boston_rpart_prune <span class="ot">=</span> <span class="fu">prune</span>(boston_largetree, <span class="at">cp =</span> <span class="fl">0.0080935</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-evaluation-3" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-3">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#in-sample prediction</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>boston_train_pred_tree_prune <span class="ot">=</span> <span class="fu">predict</span>(boston_rpart_prune, Boston_train)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the squared residuals</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>sq_residuals_tree_prune <span class="ot">&lt;-</span> (Boston_train<span class="sc">$</span>medv <span class="sc">-</span> boston_train_pred_tree_prune)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate ASE</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>ASE_regression_tree_prune <span class="ot">&lt;-</span> <span class="fu">mean</span>(sq_residuals_tree_prune)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#out-of-sample prediction </span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>boston_test_pred_tree_prune <span class="ot">=</span> <span class="fu">predict</span>(boston_rpart_prune,Boston_test)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>MSPE_regression_tree_prune <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_test<span class="sc">$</span>medv <span class="sc">-</span> boston_test_pred_tree_prune)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Pruned Regression Tree Results:</strong></p>
<ul>
<li>ASE: 14.5112512</li>
<li>MSPE: 19.5134464</li>
</ul>
</section>
</section>
</section>
<section id="k-nn-with-optimal-k" class="level3">
<h3 class="anchored" data-anchor-id="k-nn-with-optimal-k">3. k-NN with optimal k</h3>
<section id="k-nn-with-optimal-k-scaled-x" class="level4">
<h4 class="anchored" data-anchor-id="k-nn-with-optimal-k-scaled-x">k-NN with optimal k <em>(scaled X)</em></h4>
<section id="normalization" class="level5">
<h5 class="anchored" data-anchor-id="normalization">Normalization</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>train.norm <span class="ot">&lt;-</span> Boston_train</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>test.norm <span class="ot">&lt;-</span> Boston_test</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="do">## normalize numerical predictors to 0-1 scale</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="do">## for testing and training dataset </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="do">## range [0,1]-standardization ##</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train.norm[, <span class="sc">-</span><span class="dv">14</span>]) <span class="co">#scaling only on p=13 predictors X</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> cols) {</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  train.norm[[j]] <span class="ot">&lt;-</span> (train.norm[[j]] <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]])) <span class="sc">/</span> (<span class="fu">max</span>(Boston_train[[j]]) <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]]))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  test.norm[[j]] <span class="ot">&lt;-</span> (test.norm[[j]] <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]])) <span class="sc">/</span> (<span class="fu">max</span>(Boston_train[[j]]) <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]]))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="select-the-best-k" class="level5">
<h5 class="anchored" data-anchor-id="select-the-best-k">Select the Best k</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12470675</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sample_index2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(Boston_train),<span class="fu">nrow</span>(Boston_train)<span class="sc">*</span><span class="fl">0.80</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>train2.norm <span class="ot">&lt;-</span> train.norm[sample_index2,]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>valid.norm <span class="ot">&lt;-</span> train.norm[<span class="sc">-</span>sample_index2,]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize a data frame with two columns: k and accuracy</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>RMSE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">1</span>), <span class="at">RMSE.k =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># compute knn for different k on validation set</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) {</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  knn.reg.pred <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train =</span> train2.norm[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)], <span class="at">test =</span> valid.norm[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)], </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> train2.norm<span class="sc">$</span>medv, <span class="at">k =</span> i)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  RMSE.df[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((valid.norm<span class="sc">$</span>medv<span class="sc">-</span>knn.reg.pred<span class="sc">$</span>pred)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(valid.norm<span class="sc">$</span>medv))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>RMSE.df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    k   RMSE.k
1   1 5.621904
2   2 5.537119
3   3 5.223227
4   4 5.300772
5   5 5.427121
6   6 5.468343
7   7 5.539438
8   8 5.556274
9   9 5.343947
10 10 5.477418
11 11 5.480726
12 12 5.587456
13 13 5.619223
14 14 5.612212
15 15 5.685741
16 16 5.665460
17 17 5.614732
18 18 5.643805
19 19 5.663387
20 20 5.696054
21 21 5.687670
22 22 5.702366
23 23 5.681175
24 24 5.743257
25 25 5.755212
26 26 5.766532
27 27 5.791813
28 28 5.820042
29 29 5.871799
30 30 5.888626</code></pre>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">which</span>(RMSE.df[,<span class="dv">2</span>] <span class="sc">==</span> <span class="fu">min</span>(RMSE.df[,<span class="dv">2</span>]))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>I will now proceed with knn using k=3.</p>
</section>
<section id="model-creation-4" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-4">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Boston.knn.train.best.k <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train =</span> train.norm[, <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>],</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">test =</span> train.norm[, <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>],</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> train.norm<span class="sc">$</span>medv,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">k =</span> k)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>Boston.knn.best.k <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">pred =</span> Boston.knn.train.best.k<span class="sc">$</span>pred, <span class="at">actual=</span>train.norm<span class="sc">$</span>medv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-evaluation-4" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-4">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate in-sample ASE </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ASE_knn_best_k <span class="ot">&lt;-</span> <span class="fu">sum</span>((Boston_train<span class="sc">$</span>medv<span class="sc">-</span>Boston.knn.best.k<span class="sc">$</span>pred)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(Boston_train<span class="sc">$</span>medv)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Out-of-Sample Testing</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>Boston.knn.reg <span class="ot">&lt;-</span> <span class="fu">knn.reg</span>(<span class="at">train =</span> train.norm[, <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>], </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">test =</span> test.norm[, <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>], </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> train.norm<span class="sc">$</span>medv, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">k =</span> k)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>Boston.knn.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">pred =</span> Boston.knn.reg<span class="sc">$</span>pred, <span class="at">actual =</span> Boston_test<span class="sc">$</span>medv))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSPE (root mean (average) sum squared prediction errors)</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>MSPE_knn_best_k <span class="ot">&lt;-</span> <span class="fu">sum</span>((Boston_test<span class="sc">$</span>medv<span class="sc">-</span>Boston.knn.results<span class="sc">$</span>pred)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(Boston_test<span class="sc">$</span>medv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>k-NN Model Results:</strong></p>
<ul>
<li>ASE: 9.4693399</li>
<li>MSPE: 14.4688998</li>
</ul>
</section>
</section>
</section>
<section id="random-forests" class="level3">
<h3 class="anchored" data-anchor-id="random-forests">4. Random Forests</h3>
<section id="random-forests-1" class="level4">
<h4 class="anchored" data-anchor-id="random-forests-1">Random Forests</h4>
<section id="model-creation-5" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-5">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Boston_rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv<span class="sc">~</span>., </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> Boston_train, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                Length Class  Mode     
call              4    -none- call     
type              1    -none- character
predicted       404    -none- numeric  
mse             500    -none- numeric  
rsq             500    -none- numeric  
oob.times       404    -none- numeric  
importance       26    -none- numeric  
importanceSD     13    -none- numeric  
localImportance   0    -none- NULL     
proximity         0    -none- NULL     
ntree             1    -none- numeric  
mtry              1    -none- numeric  
forest           11    -none- list     
coefs             0    -none- NULL     
y               404    -none- numeric  
test              0    -none- NULL     
inbag             0    -none- NULL     
terms             3    terms  call     </code></pre>
</div>
</div>
</section>
<section id="model-evaluation-5" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-5">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prediction on training sample</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>Boston_rf_pred_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_rf, Boston_train)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample ASE</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>ASE_random_forest <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_train<span class="sc">$</span>medv<span class="sc">-</span>Boston_rf_pred_train)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot out of bag (OOB) errors for each ntree value from 1 to 500</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Boston_rf<span class="sc">$</span>mse, <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"ntree"</span>, <span class="at">ylab =</span> <span class="st">"OOB Error"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prediction on testing sample</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Boston_rf_pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_rf, Boston_test)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample MSPE</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>MSPE_random_forest <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_test<span class="sc">$</span>medv<span class="sc">-</span>Boston_rf_pred_test)<span class="sc">^</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Random Forest Model Results:</strong></p>
<ul>
<li>ASE: 2.0348652</li>
<li>MSPE: 9.7253342</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make dataframe from importance() output</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>feat_imp_df <span class="ot">&lt;-</span> <span class="fu">importance</span>(Boston_rf) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feature =</span> <span class="fu">row.names</span>(.)) </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>feat_imp_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         X.IncMSE IncNodePurity feature
crim    12.860544     2016.1703    crim
zn       3.600826      282.7530      zn
indus   11.945734     1833.4535   indus
chas     3.254583      226.8842    chas
nox     14.747549     1938.0660     nox
rm      33.558932     9695.3299      rm
age      9.884350      870.5076     age
dis     16.850483     2175.4557     dis
rad      6.271453      275.9496     rad
tax     12.798919     1347.8094     tax
ptratio 15.568195     2010.3849 ptratio
black    8.149253      630.6317   black
lstat   30.419021    10689.2994   lstat</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot dataframe</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feat_imp_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(feature, X.IncMSE), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> X.IncMSE)) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Feature"</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Importance"</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Feature Importance: Random Forest Model"</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="boosting" class="level3">
<h3 class="anchored" data-anchor-id="boosting">5. Boosting</h3>
<section id="boosting-1" class="level4">
<h4 class="anchored" data-anchor-id="boosting-1">Boosting</h4>
<section id="model-creation-6" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-6">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Boston_boost <span class="ot">&lt;-</span> <span class="fu">gbm</span>(<span class="at">formula =</span> medv<span class="sc">~</span>., </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Boston_train, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">distribution =</span> <span class="st">"gaussian"</span>, <span class="at">n.trees=</span><span class="dv">500</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston_boost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            var     rel.inf
lstat     lstat 44.57254169
rm           rm 27.32190164
dis         dis  9.37157973
crim       crim  5.32804699
nox         nox  3.68903169
ptratio ptratio  2.40416779
chas       chas  1.90724054
black     black  1.60113862
age         age  1.44095203
tax         tax  1.31516866
indus     indus  0.53919314
rad         rad  0.47272127
zn           zn  0.03631621</code></pre>
</div>
</div>
</section>
<section id="model-evaluation-6" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-6">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample prediction</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Boston_boost_pred_train<span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_boost, Boston_train, <span class="at">n.trees=</span><span class="dv">500</span>) </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample ASE</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ASE_boosting <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_train<span class="sc">$</span>medv<span class="sc">-</span>Boston_boost_pred_train)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample prediction </span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>Boston_boost_pred_test<span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_boost, Boston_test, <span class="at">n.trees=</span><span class="dv">500</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample MSPE</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>MSPE_boosting <span class="ot">&lt;-</span> <span class="fu">mean</span>((Boston_test<span class="sc">$</span>medv<span class="sc">-</span>Boston_boost_pred_test)<span class="sc">^</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Boosting Model Results:</strong></p>
<ul>
<li>ASE: 7.0525458</li>
<li>MSPE: 14.2900702</li>
</ul>
</section>
</section>
</section>
<section id="gam" class="level3">
<h3 class="anchored" data-anchor-id="gam">6. GAM</h3>
<section id="generalized-additive-model-gam" class="level4">
<h4 class="anchored" data-anchor-id="generalized-additive-model-gam">Generalized Additive Model (GAM)</h4>
<section id="model-creation-7" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-7">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>Boston_gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(medv <span class="sc">~</span> <span class="fu">s</span>(crim)<span class="sc">+</span><span class="fu">s</span>(zn)<span class="sc">+</span><span class="fu">s</span>(indus)<span class="sc">+</span>chas<span class="sc">+</span><span class="fu">s</span>(nox)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span><span class="fu">s</span>(rm)<span class="sc">+</span><span class="fu">s</span>(age)<span class="sc">+</span><span class="fu">s</span>(dis)<span class="sc">+</span>rad<span class="sc">+</span><span class="fu">s</span>(tax)<span class="sc">+</span><span class="fu">s</span>(ptratio)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span><span class="fu">s</span>(black)<span class="sc">+</span><span class="fu">s</span>(lstat),<span class="at">data=</span>Boston_train)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston_gam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
medv ~ s(crim) + s(zn) + s(indus) + chas + s(nox) + s(rm) + s(age) + 
    s(dis) + rad + s(tax) + s(ptratio) + s(black) + s(lstat)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  18.1806     1.2017  15.129  &lt; 2e-16 ***
chas          1.2160     0.6488   1.874 0.061730 .  
rad           0.4605     0.1240   3.713 0.000238 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
             edf Ref.df      F  p-value    
s(crim)    5.916  7.012  8.693  &lt; 2e-16 ***
s(zn)      1.000  1.000  0.034 0.853602    
s(indus)   7.422  8.295  3.352 0.000912 ***
s(nox)     8.929  8.993 14.465  &lt; 2e-16 ***
s(rm)      8.382  8.879 19.995  &lt; 2e-16 ***
s(age)     1.000  1.000  0.159 0.690632    
s(dis)     8.807  8.983  8.010  &lt; 2e-16 ***
s(tax)     3.236  3.906  9.922 5.72e-07 ***
s(ptratio) 1.440  1.755 16.612 3.51e-06 ***
s(black)   1.872  2.314  2.387 0.073678 .  
s(lstat)   6.159  7.348 25.397  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.898   Deviance explained = 91.2%
GCV = 10.166  Scale est. = 8.7276    n = 404</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Boston_gam, <span class="at">shade=</span><span class="cn">TRUE</span>, <span class="at">seWithMean=</span><span class="cn">TRUE</span>, <span class="at">scale=</span><span class="dv">0</span>, <span class="at">pages=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="refit-gam-model" class="level6">
<h6 class="anchored" data-anchor-id="refit-gam-model">Refit GAM Model</h6>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#refit  gam on Boston training (nonlinear to linear)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>Boston_gam_re <span class="ot">&lt;-</span> <span class="fu">gam</span>(medv <span class="sc">~</span> <span class="fu">s</span>(crim)<span class="sc">+</span>zn<span class="sc">+</span><span class="fu">s</span>(indus)<span class="sc">+</span>chas<span class="sc">+</span><span class="fu">s</span>(nox)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span><span class="fu">s</span>(rm)<span class="sc">+</span>age<span class="sc">+</span><span class="fu">s</span>(dis)<span class="sc">+</span>rad<span class="sc">+</span><span class="fu">s</span>(tax)<span class="sc">+</span>ptratio</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">+</span><span class="fu">s</span>(black)<span class="sc">+</span><span class="fu">s</span>(lstat),<span class="at">data=</span>Boston_train)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston_gam_re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
medv ~ s(crim) + zn + s(indus) + chas + s(nox) + s(rm) + age + 
    s(dis) + rad + s(tax) + ptratio + s(black) + s(lstat)

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.211217   2.848995  10.604  &lt; 2e-16 ***
zn          -0.002212   0.014530  -0.152 0.879099    
chas         1.233321   0.649491   1.899 0.058406 .  
age          0.004472   0.011862   0.377 0.706402    
rad          0.451044   0.123098   3.664 0.000287 ***
ptratio     -0.663635   0.127633  -5.200 3.42e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
           edf Ref.df      F  p-value    
s(crim)  5.858  6.955  8.707  &lt; 2e-16 ***
s(indus) 7.603  8.434  3.472 0.000595 ***
s(nox)   8.968  8.997 14.634  &lt; 2e-16 ***
s(rm)    8.412  8.889 20.584  &lt; 2e-16 ***
s(dis)   8.776  8.980  7.890  &lt; 2e-16 ***
s(tax)   3.077  3.730 10.173 6.06e-07 ***
s(black) 1.904  2.353  2.479 0.065031 .  
s(lstat) 6.146  7.337 25.227  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.898   Deviance explained = 91.2%
GCV = 10.172  Scale est. = 8.7433    n = 404</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Boston_gam_re, <span class="at">shade=</span><span class="cn">TRUE</span>, <span class="at">seWithMean=</span><span class="cn">TRUE</span>, <span class="at">scale=</span><span class="dv">0</span>, <span class="at">pages=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="refit-gam-model-and-remove-insignificant-variables" class="level6">
<h6 class="anchored" data-anchor-id="refit-gam-model-and-remove-insignificant-variables">Refit GAM Model and Remove Insignificant Variables</h6>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#refit  gam on Boston training (remove nonsignificant variables)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>Boston_gam_final <span class="ot">&lt;-</span> <span class="fu">gam</span>(medv <span class="sc">~</span> <span class="fu">s</span>(crim)<span class="sc">+</span><span class="fu">s</span>(indus)<span class="sc">+</span><span class="fu">s</span>(nox)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">s</span>(rm)<span class="sc">+</span><span class="fu">s</span>(dis)<span class="sc">+</span>rad<span class="sc">+</span><span class="fu">s</span>(tax)<span class="sc">+</span>ptratio</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">s</span>(lstat),<span class="at">data=</span>Boston_train)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston_gam_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
medv ~ s(crim) + s(indus) + s(nox) + s(rm) + s(dis) + rad + s(tax) + 
    ptratio + s(lstat)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  31.5527     2.6804  11.772  &lt; 2e-16 ***
rad           0.4359     0.1218   3.579 0.000393 ***
ptratio      -0.7083     0.1240  -5.713 2.36e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
           edf Ref.df     F p-value    
s(crim)  6.107  7.206 10.04 &lt; 2e-16 ***
s(indus) 7.232  8.163  3.22 0.00142 ** 
s(nox)   8.960  8.996 15.25 &lt; 2e-16 ***
s(rm)    8.256  8.834 21.53 &lt; 2e-16 ***
s(dis)   8.820  8.986 11.27 &lt; 2e-16 ***
s(tax)   3.303  3.994 10.37 &lt; 2e-16 ***
s(lstat) 6.122  7.311 33.33 &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.896   Deviance explained = 90.9%
GCV = 10.203  Scale est. = 8.8947    n = 404</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Boston_gam_final, <span class="at">shade=</span><span class="cn">TRUE</span>, <span class="at">seWithMean=</span><span class="cn">TRUE</span>, <span class="at">scale=</span><span class="dv">0</span>, <span class="at">pages=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="BostonHousing_Code_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-evaluation-7" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-7">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample ASE</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>ASE_gam.orig <span class="ot">&lt;-</span> Boston_gam<span class="sc">$</span>dev<span class="sc">/</span><span class="fu">nrow</span>(Boston_train) <span class="co">#original model</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>ASE_gam.re <span class="ot">&lt;-</span> Boston_gam_re<span class="sc">$</span>dev<span class="sc">/</span><span class="fu">nrow</span>(Boston_train) <span class="co">#adjusted model</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>ASE_gam.final <span class="ot">&lt;-</span> Boston_gam_final<span class="sc">$</span>dev<span class="sc">/</span><span class="fu">nrow</span>(Boston_train) <span class="co">#final model</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#out of sample MSPE</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>pred_gam_orig_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_gam,Boston_test)<span class="co">#final model</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>MSPE_gam.orig <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_gam_orig_test <span class="sc">-</span> Boston_test<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>pred_gam_re_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_gam_re, Boston_test)<span class="co">#final model</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>MSPE_gam.re <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_gam_re_test <span class="sc">-</span> Boston_test<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>pred_gam_final_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(Boston_gam_final,Boston_test)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>MSPE_gam.final <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_gam_final_test <span class="sc">-</span> Boston_test<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>GAM Model Results:</strong></p>
<p><strong>Original GAM Model</strong></p>
<ul>
<li>ASE: 7.4927448</li>
<li>MSPE: 17.0712952</li>
</ul>
<p><strong>Adjusted GAM Model (nonlinear to linear)</strong></p>
<ul>
<li>ASE: 7.5152732</li>
<li>MSPE: 17.0894678</li>
</ul>
<p><strong>Final GAM Model (remove insignificant variables)</strong></p>
<ul>
<li>ASE: 7.7542537</li>
<li>MSPE: 16.2152644</li>
</ul>
</section>
</section>
</section>
<section id="neural-networks" class="level3">
<h3 class="anchored" data-anchor-id="neural-networks">7. Neural Networks</h3>
<section id="neural-networks-scaled-xy" class="level4">
<h4 class="anchored" data-anchor-id="neural-networks-scaled-xy">Neural Networks <em>(scaled X&amp;Y)</em></h4>
<section id="scale-x-and-y" class="level5">
<h5 class="anchored" data-anchor-id="scale-x-and-y">Scale X and Y</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## initialize scaling training, testing, and new data frames to originals ##</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>train.norm <span class="ot">&lt;-</span> Boston_train</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>test.norm <span class="ot">&lt;-</span> Boston_test</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="do">## normalize all numerical variables (X&amp;Y) to 0-1 scale, range [0,1]-standardization ##</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train.norm[, ]) <span class="co">#scaling both X and Y</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> cols) {</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  train.norm[[j]] <span class="ot">&lt;-</span> (train.norm[[j]] <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]])) <span class="sc">/</span> (<span class="fu">max</span>(Boston_train[[j]]) <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]]))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  test.norm[[j]] <span class="ot">&lt;-</span> (test.norm[[j]] <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]])) <span class="sc">/</span> (<span class="fu">max</span>(Boston_train[[j]]) <span class="sc">-</span> <span class="fu">min</span>(Boston_train[[j]]))</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-creation-8" class="level5">
<h5 class="anchored" data-anchor-id="model-creation-8">Model Creation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Neural networks on (scaled) Training data and plot ####</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12470675</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="st">"medv ~ ."</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>Boston_nn_scaled <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(f,<span class="at">data=</span>train.norm, <span class="at">hidden=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">3</span>), <span class="at">linear.output=</span>T)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Boston_nn_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-evaluation-8" class="level5">
<h5 class="anchored" data-anchor-id="model-evaluation-8">Model Evaluation</h5>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample prediction</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>pr_nn_scaled_train <span class="ot">&lt;-</span> <span class="fu">compute</span>(Boston_nn_scaled, train.norm[,<span class="dv">1</span><span class="sc">:</span>p])</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># recover predicted value back to the original response scale </span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>pr_nn_org <span class="ot">&lt;-</span> pr_nn_scaled_train<span class="sc">$</span>net.result<span class="sc">*</span>(<span class="fu">max</span>(Boston_train<span class="sc">$</span>medv)<span class="sc">-</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv))<span class="sc">+</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>train_r <span class="ot">&lt;-</span> (train.norm<span class="sc">$</span>medv)<span class="sc">*</span>(<span class="fu">max</span>(Boston_train<span class="sc">$</span>medv)<span class="sc">-</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv))<span class="sc">+</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># in-sample ASE</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>ASE_nn.norm <span class="ot">&lt;-</span> <span class="fu">mean</span>((train_r <span class="sc">-</span> pr_nn_org)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample prediction</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>pr_nn_scaled_test <span class="ot">&lt;-</span> <span class="fu">compute</span>(Boston_nn_scaled, test.norm[,<span class="dv">1</span><span class="sc">:</span>p])</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># recover predicted value back to the original response scale </span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>pr_nn_org_t <span class="ot">&lt;-</span> pr_nn_scaled_test<span class="sc">$</span>net.result<span class="sc">*</span>(<span class="fu">max</span>(Boston_train<span class="sc">$</span>medv)<span class="sc">-</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv))<span class="sc">+</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>test_r <span class="ot">&lt;-</span> (test.norm<span class="sc">$</span>medv)<span class="sc">*</span>(<span class="fu">max</span>(Boston_train<span class="sc">$</span>medv)<span class="sc">-</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv))<span class="sc">+</span><span class="fu">min</span>(Boston_train<span class="sc">$</span>medv)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co"># out-of-sample MSPE</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>MSPE_nn.norm <span class="ot">&lt;-</span> <span class="fu">mean</span>((test_r <span class="sc">-</span> pr_nn_org_t)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Neural Network Model Results:</strong></p>
<ul>
<li>ASE: 4.608239</li>
<li>MSPE: 11.9294593</li>
</ul>
</section>
</section>
</section>
</section>
<section id="summary-of-model-results" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-model-results">Summary of Model Results</h2>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create list of models created</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Full Linear Regression"</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Stepwise Variable Selection LM with AIC"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Original Regression Tree"</span>, </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Pruned Regression Tree"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"k-NN with optimal k (scaled X)"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Random Forests"</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Boosting"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Original Generalized Additive Model (GAM)"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Adjusted Generalized Additive Model (GAM)"</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Final Generalized Additive Model (GAM)"</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Neural Networks (scaled X&amp;Y)"</span>)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>ASE_values <span class="ot">&lt;-</span> <span class="fu">c</span>(ASE_full_linear, ASE_step_AIC, ASE_regression_tree, </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>                ASE_regression_tree_prune, ASE_knn_best_k,</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                ASE_random_forest, ASE_boosting,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                ASE_gam.orig, ASE_gam.re, ASE_gam.final,</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>                ASE_nn.norm)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>MSPE_values <span class="ot">&lt;-</span> <span class="fu">c</span>(MSPE_full_linear, MSPE_step_AIC, MSPE_regression_tree, </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                 MSPE_regression_tree_prune, MSPE_knn_best_k,</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                 MSPE_random_forest, MSPE_boosting,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                 MSPE_gam.orig, MSPE_gam.re, MSPE_gam.final,</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>                 MSPE_nn.norm)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataframe</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>model_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Method =</span> models, <span class="at">ASE =</span> ASE_values, <span class="at">MSPE =</span> MSPE_values)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(model_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: right;">ASE</th>
<th style="text-align: right;">MSPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Full Linear Regression</td>
<td style="text-align: right;">21.913645</td>
<td style="text-align: right;">23.472129</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stepwise Variable Selection LM with AIC</td>
<td style="text-align: right;">22.001113</td>
<td style="text-align: right;">22.730849</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Original Regression Tree</td>
<td style="text-align: right;">16.764289</td>
<td style="text-align: right;">21.838535</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pruned Regression Tree</td>
<td style="text-align: right;">14.511251</td>
<td style="text-align: right;">19.513446</td>
</tr>
<tr class="odd">
<td style="text-align: left;">k-NN with optimal k (scaled X)</td>
<td style="text-align: right;">9.469340</td>
<td style="text-align: right;">14.468900</td>
</tr>
<tr class="even">
<td style="text-align: left;">Random Forests</td>
<td style="text-align: right;">2.034865</td>
<td style="text-align: right;">9.725334</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boosting</td>
<td style="text-align: right;">7.052546</td>
<td style="text-align: right;">14.290070</td>
</tr>
<tr class="even">
<td style="text-align: left;">Original Generalized Additive Model (GAM)</td>
<td style="text-align: right;">7.492745</td>
<td style="text-align: right;">17.071295</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adjusted Generalized Additive Model (GAM)</td>
<td style="text-align: right;">7.515273</td>
<td style="text-align: right;">17.089468</td>
</tr>
<tr class="even">
<td style="text-align: left;">Final Generalized Additive Model (GAM)</td>
<td style="text-align: right;">7.754254</td>
<td style="text-align: right;">16.215264</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neural Networks (scaled X&amp;Y)</td>
<td style="text-align: right;">4.608239</td>
<td style="text-align: right;">11.929459</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>From the evaluation metrics summarized above, it is clear that the Random Forests model performs the best. The ASE and MSPE for this model are significantly lower than those for all of the other models. The Neural Networks model also performs well. Conversely, the Full Linear Regression model performs the worst. However, I do believe that it likely makes the most sense to use the linear regression model for this data and the potential uses of the analysis.</p>
<p>Finally, based on feature importance from the Random Forest model, as well as the regression coefficients from the Stepwise Variable Selection Linear Regression Model with AIC, I conclude that the most influential features are ‘rm’, ‘lstat’, and ‘dis’.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>